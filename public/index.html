<!DOCTYPE html>
<html>

<head>
    <title>Go Scrcpy WebRTC</title>
    <link rel="stylesheet" href="static/css/index.css">
</head>

<body>
    <div class="main-container">
        <div class="video-container">
            <video id="remoteVideo" autoplay muted playsinline></video>
        </div>
        <div class="controls-container">
            <button onclick="start()" class="control-btn primary">连接</button>
            <div class="separator"></div>
            <button onclick="homeButton()" class="control-btn">主页</button>
            <button onclick="volumeUpButton()" class="control-btn">音量+</button>
            <button onclick="volumeDownButton()" class="control-btn">音量-</button>
            <button onclick="powerButton()" class="control-btn">电源</button>
        </div>
    </div>
    <script>
        // Debounce/Throttle check
        let checkTimeout;
        function triggerCheck() {
            clearTimeout(checkTimeout);
            checkTimeout = setTimeout(checkOrientation, 500);
        }

        window.addEventListener('resize', triggerCheck);

        function checkOrientation() {
            const video = document.getElementById('remoteVideo');
            if (!video.videoWidth || !video.videoHeight) return;

            const isPagePortrait = window.innerHeight > window.innerWidth;
            const isVideoLandscape = video.videoWidth > video.videoHeight;

            const isPageLandscape = window.innerWidth > window.innerHeight;
            const isVideoPortrait = video.videoHeight > video.videoWidth;

            if (isPagePortrait && isVideoLandscape) {
                // console.log("Auto-rotating: Page Portrait, Video Landscape");
                p = createRotatePacket();
                sendButtonEvent(p);
            } else if (isPageLandscape && isVideoPortrait) {
                // console.log("Auto-rotating: Page Landscape, Video Portrait");
                p = createRotatePacket();
                sendButtonEvent(p);
            }
        }
        //start();
    </script>
    <script src="static/controlMessages.js"></script>
    <script src="static/buttons.js"></script>
    <script src="static/touch.js"></script>
    <script src="static/keyboard.js"></script>
    <script src="static/scroll.js"></script>
    <script src="static/connect.js"></script>
</body>

</html>